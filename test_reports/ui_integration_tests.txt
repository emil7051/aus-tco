============================= test session starts ==============================
platform darwin -- Python 3.11.9, pytest-8.3.5, pluggy-1.5.0 -- /Users/edwardmiller/dev/aus-tco/venv/bin/python3.11
cachedir: .pytest_cache
rootdir: /Users/edwardmiller/dev/aus-tco
configfile: pytest.ini
plugins: cov-6.1.1
collecting ... collected 10 items

tests/integration/test_ui_integration.py::TestNavigationIntegration::test_navigation_state_persistence PASSED [ 10%]
tests/integration/test_ui_integration.py::TestNavigationIntegration::test_step_based_ui_rendering PASSED [ 20%]
tests/integration/test_ui_integration.py::TestFormValidationIntegration::test_vehicle_parameter_validation PASSED [ 30%]
tests/integration/test_ui_integration.py::TestFormValidationIntegration::test_input_validation_feedback PASSED [ 40%]
tests/integration/test_ui_integration.py::TestThemeIntegration::test_theme_application_to_components FAILED [ 50%]
tests/integration/test_ui_integration.py::TestSideBySideLayoutIntegration::test_switching_layout_modes FAILED [ 60%]
tests/integration/test_ui_integration.py::TestResultsIntegration::test_dashboard_integration FAILED [ 70%]
tests/integration/test_ui_integration.py::TestResultsIntegration::test_environmental_dashboard_integration FAILED [ 80%]
tests/integration/test_ui_integration.py::TestEndToEndWorkflow::test_full_calculation_workflow FAILED [ 90%]
tests/integration/test_ui_integration.py::TestEndToEndWorkflow::test_configuration_persistence PASSED [100%]

=================================== FAILURES ===================================
__________ TestThemeIntegration.test_theme_application_to_components ___________

self = <tests.integration.test_ui_integration.TestThemeIntegration object at 0x11edc2a10>
ui_theme_config = {'available_themes': ['default', 'high_contrast', 'dark'], 'current_theme': 'default', 'high_contrast': False}

    def test_theme_application_to_components(self, ui_theme_config):
        """Test theme application to UI components."""
        from ui.theme import switch_theme, apply_theme_to_app
        from utils.ui_components import UIComponentFactory
    
        # Switch to high contrast theme
        new_config = switch_theme(ui_theme_config, "high_contrast")
    
        # Apply theme to app
        app_html = apply_theme_to_app(new_config)
    
        # Verify theme CSS is included
>       assert "high_contrast" in app_html.lower()
E       assert 'high_contrast' in '<style>/* ==========================================================================\n   high contrast theme for accessibility\n   ========================================================================== */\n\n:root {\n  /* base theme colors - high contrast for accessibility */\n  --bg-primary: #000000;\n  --bg-secondary: #1a1a1a;\n  --bg-tertiary: #2a2a2a;\n  --text-primary: #ffffff;\n  --text-secondary: #eeeeee;\n  --border-color: #ffffff;\n  --divider-color: #555555;\n  \n  /* high contrast specific rgb values for opacity usage */\n  --bet-primary-rgb: 0, 230, 200;\n  --diesel-primary-rgb: 255, 170, 0;\n  --error-color-rgb: 255, 80, 80;\n  --warning-color-rgb: 255, 190, 0;\n  --success-color-rgb: 50, 220, 50;\n  \n  /* adjusted component colors for better contrast */\n  --acquisition-color: #0099ff;\n  --energy-color: #ffaa00;\n  --maintenance-color: #00cc00;\n  --infrastructure-color: #ff5050;\n  --battery-color: #cc66ff;\n  --insurance-color: #ff66cc;\n  --taxes-color: #ff99cc;\n  --residual-color: #bbbbbb;\n  \n  /* vehicle type colors with higher contrast */\n  --bet-primary: #00e6c8;\n  --diesel-primary: #ffaa00;\n  \n  /* australian-themed accents with higher contrast */\n  --aus-green: #00ff77;\n  --aus-gold: #ffd700;\n  \n  /* status colors with higher contrast */\n  --success-color: #32dc32;\n  --warning-color: #ffbe00;\n  --error-color: #ff5050;\n  --info-color: #0099ff;\n  \n  /* ui element colors */\n  --card-bg: #1a1a1a;\n  --card-border: #ffffff;\n  --card-shadow: rgba(255, 255, 255, 0.2);\n  --input-bg: #1a1a1a;\n  --input-border: #ffffff;\n  --input-focus-border: #00e6c8;\n  --input-placeholder: #bbbbbb;\n  \n  /* chart colors */\n  --chart-grid-color: rgba(255, 255, 255, 0.3);\n  --chart-axis-color: rgba(255, 255, 255, 0.8);\n  --chart-tooltip-bg: rgba(0, 0, 0, 0.9);\n}\n\n/* high contrast theme specific adjustments */\nbody, .stapp {\n  background-color: var(--bg-primary);\n  color: var(--text-primary);\n}\n\n/* thicker borders for better visibility */\n.card, \n[data-testid="stexpander"], \n.sttextinput input,\n.stnumberinput input,\n.stdateinput input,\n.stselectbox > div[data-baseweb="select"] > div {\n  border-width: 2px;\n}\n\n/* higher contrast focus states */\n.sttextinput input:focus,\n.stnumberinput input:focus,\n.stdateinput input:focus,\n.stselectbox > div[data-baseweb="select"] > div:focus,\n.stbutton > button:focus {\n  outline: 2px solid var(--bet-primary);\n  box-shadow: 0 0 0 4px rgba(var(--bet-primary-rgb), 0.4);\n}\n\n/* buttons with higher contrast */\n.stbutton > button {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary);\n  font-weight: var(--font-weight-bold);\n}\n\n.stbutton > button:hover {\n  background-color: var(--text-primary);\n  color: var(--bg-primary);\n}\n\n/* form elements */\n.stcheckbox label span[role="checkbox"],\n.stradio label span[role="radio"] {\n  border-color: var(--text-primary);\n  border-width: 2px;\n}\n\n.stcheckbox label span[role="checkbox"][data-checked="true"],\n.stradio label span[role="radio"][data-checked="true"] {\n  background-color: var(--bet-primary);\n  border-color: var(--bet-primary);\n}\n\n/* improved contrast for tabs */\n.sttabs [data-baseweb="tab-list"] {\n  background-color: var(--bg-secondary);\n  border: 2px solid var(--border-color);\n}\n\n.sttabs [data-baseweb="tab"] {\n  color: var(--text-primary);\n}\n\n.sttabs [aria-selected="true"] {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary) !important;\n  font-weight: var(--font-weight-bold);\n}\n\n/* tables with better contrast */\ntable th {\n  background-color: var(--bg-tertiary);\n  color: var(--text-primary);\n  border: 2px solid var(--border-color);\n}\n\ntable td {\n  border: 1px solid var(--divider-color);\n}\n\n/* more pronounced impact indicators */\n.impact-indicator.high {\n  background-color: var(--error-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.medium {\n  background-color: var(--warning-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.low {\n  background-color: var(--success-color);\n  color: var(--bg-primary);\n} </style>'
E        +  where '<style>/* ==========================================================================\n   high contrast theme for accessibility\n   ========================================================================== */\n\n:root {\n  /* base theme colors - high contrast for accessibility */\n  --bg-primary: #000000;\n  --bg-secondary: #1a1a1a;\n  --bg-tertiary: #2a2a2a;\n  --text-primary: #ffffff;\n  --text-secondary: #eeeeee;\n  --border-color: #ffffff;\n  --divider-color: #555555;\n  \n  /* high contrast specific rgb values for opacity usage */\n  --bet-primary-rgb: 0, 230, 200;\n  --diesel-primary-rgb: 255, 170, 0;\n  --error-color-rgb: 255, 80, 80;\n  --warning-color-rgb: 255, 190, 0;\n  --success-color-rgb: 50, 220, 50;\n  \n  /* adjusted component colors for better contrast */\n  --acquisition-color: #0099ff;\n  --energy-color: #ffaa00;\n  --maintenance-color: #00cc00;\n  --infrastructure-color: #ff5050;\n  --battery-color: #cc66ff;\n  --insurance-color: #ff66cc;\n  --taxes-color: #ff99cc;\n  --residual-color: #bbbbbb;\n  \n  /* vehicle type colors with higher contrast */\n  --bet-primary: #00e6c8;\n  --diesel-primary: #ffaa00;\n  \n  /* australian-themed accents with higher contrast */\n  --aus-green: #00ff77;\n  --aus-gold: #ffd700;\n  \n  /* status colors with higher contrast */\n  --success-color: #32dc32;\n  --warning-color: #ffbe00;\n  --error-color: #ff5050;\n  --info-color: #0099ff;\n  \n  /* ui element colors */\n  --card-bg: #1a1a1a;\n  --card-border: #ffffff;\n  --card-shadow: rgba(255, 255, 255, 0.2);\n  --input-bg: #1a1a1a;\n  --input-border: #ffffff;\n  --input-focus-border: #00e6c8;\n  --input-placeholder: #bbbbbb;\n  \n  /* chart colors */\n  --chart-grid-color: rgba(255, 255, 255, 0.3);\n  --chart-axis-color: rgba(255, 255, 255, 0.8);\n  --chart-tooltip-bg: rgba(0, 0, 0, 0.9);\n}\n\n/* high contrast theme specific adjustments */\nbody, .stapp {\n  background-color: var(--bg-primary);\n  color: var(--text-primary);\n}\n\n/* thicker borders for better visibility */\n.card, \n[data-testid="stexpander"], \n.sttextinput input,\n.stnumberinput input,\n.stdateinput input,\n.stselectbox > div[data-baseweb="select"] > div {\n  border-width: 2px;\n}\n\n/* higher contrast focus states */\n.sttextinput input:focus,\n.stnumberinput input:focus,\n.stdateinput input:focus,\n.stselectbox > div[data-baseweb="select"] > div:focus,\n.stbutton > button:focus {\n  outline: 2px solid var(--bet-primary);\n  box-shadow: 0 0 0 4px rgba(var(--bet-primary-rgb), 0.4);\n}\n\n/* buttons with higher contrast */\n.stbutton > button {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary);\n  font-weight: var(--font-weight-bold);\n}\n\n.stbutton > button:hover {\n  background-color: var(--text-primary);\n  color: var(--bg-primary);\n}\n\n/* form elements */\n.stcheckbox label span[role="checkbox"],\n.stradio label span[role="radio"] {\n  border-color: var(--text-primary);\n  border-width: 2px;\n}\n\n.stcheckbox label span[role="checkbox"][data-checked="true"],\n.stradio label span[role="radio"][data-checked="true"] {\n  background-color: var(--bet-primary);\n  border-color: var(--bet-primary);\n}\n\n/* improved contrast for tabs */\n.sttabs [data-baseweb="tab-list"] {\n  background-color: var(--bg-secondary);\n  border: 2px solid var(--border-color);\n}\n\n.sttabs [data-baseweb="tab"] {\n  color: var(--text-primary);\n}\n\n.sttabs [aria-selected="true"] {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary) !important;\n  font-weight: var(--font-weight-bold);\n}\n\n/* tables with better contrast */\ntable th {\n  background-color: var(--bg-tertiary);\n  color: var(--text-primary);\n  border: 2px solid var(--border-color);\n}\n\ntable td {\n  border: 1px solid var(--divider-color);\n}\n\n/* more pronounced impact indicators */\n.impact-indicator.high {\n  background-color: var(--error-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.medium {\n  background-color: var(--warning-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.low {\n  background-color: var(--success-color);\n  color: var(--bg-primary);\n} </style>' = <built-in method lower of str object at 0x128b75e00>()
E        +    where <built-in method lower of str object at 0x128b75e00> = '<style>/* ==========================================================================\n   High Contrast Theme for Accessibility\n   ========================================================================== */\n\n:root {\n  /* Base theme colors - high contrast for accessibility */\n  --bg-primary: #000000;\n  --bg-secondary: #1a1a1a;\n  --bg-tertiary: #2a2a2a;\n  --text-primary: #ffffff;\n  --text-secondary: #eeeeee;\n  --border-color: #ffffff;\n  --divider-color: #555555;\n  \n  /* High contrast specific RGB values for opacity usage */\n  --bet-primary-rgb: 0, 230, 200;\n  --diesel-primary-rgb: 255, 170, 0;\n  --error-color-rgb: 255, 80, 80;\n  --warning-color-rgb: 255, 190, 0;\n  --success-color-rgb: 50, 220, 50;\n  \n  /* Adjusted component colors for better contrast */\n  --acquisition-color: #0099ff;\n  --energy-color: #ffaa00;\n  --maintenance-color: #00cc00;\n  --infrastructure-color: #ff5050;\n  --battery-color: #cc66ff;\n  --insurance-color: #ff66cc;\n  --taxes-color: #ff99cc;\n  --residual-color: #bbbbbb;\n  \n  /* Vehicle type colors with higher contrast */\n  --bet-primary: #00E6C8;\n  --diesel-primary: #FFAA00;\n  \n  /* Australian-themed accents with higher contrast */\n  --aus-green: #00FF77;\n  --aus-gold: #FFD700;\n  \n  /* Status colors with higher contrast */\n  --success-color: #32DC32;\n  --warning-color: #FFBE00;\n  --error-color: #FF5050;\n  --info-color: #0099FF;\n  \n  /* UI element colors */\n  --card-bg: #1a1a1a;\n  --card-border: #ffffff;\n  --card-shadow: rgba(255, 255, 255, 0.2);\n  --input-bg: #1a1a1a;\n  --input-border: #ffffff;\n  --input-focus-border: #00E6C8;\n  --input-placeholder: #bbbbbb;\n  \n  /* Chart colors */\n  --chart-grid-color: rgba(255, 255, 255, 0.3);\n  --chart-axis-color: rgba(255, 255, 255, 0.8);\n  --chart-tooltip-bg: rgba(0, 0, 0, 0.9);\n}\n\n/* High contrast theme specific adjustments */\nbody, .stApp {\n  background-color: var(--bg-primary);\n  color: var(--text-primary);\n}\n\n/* Thicker borders for better visibility */\n.card, \n[data-testid="stExpander"], \n.stTextInput input,\n.stNumberInput input,\n.stDateInput input,\n.stSelectbox > div[data-baseweb="select"] > div {\n  border-width: 2px;\n}\n\n/* Higher contrast focus states */\n.stTextInput input:focus,\n.stNumberInput input:focus,\n.stDateInput input:focus,\n.stSelectbox > div[data-baseweb="select"] > div:focus,\n.stButton > button:focus {\n  outline: 2px solid var(--bet-primary);\n  box-shadow: 0 0 0 4px rgba(var(--bet-primary-rgb), 0.4);\n}\n\n/* Buttons with higher contrast */\n.stButton > button {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary);\n  font-weight: var(--font-weight-bold);\n}\n\n.stButton > button:hover {\n  background-color: var(--text-primary);\n  color: var(--bg-primary);\n}\n\n/* Form elements */\n.stCheckbox label span[role="checkbox"],\n.stRadio label span[role="radio"] {\n  border-color: var(--text-primary);\n  border-width: 2px;\n}\n\n.stCheckbox label span[role="checkbox"][data-checked="true"],\n.stRadio label span[role="radio"][data-checked="true"] {\n  background-color: var(--bet-primary);\n  border-color: var(--bet-primary);\n}\n\n/* Improved contrast for tabs */\n.stTabs [data-baseweb="tab-list"] {\n  background-color: var(--bg-secondary);\n  border: 2px solid var(--border-color);\n}\n\n.stTabs [data-baseweb="tab"] {\n  color: var(--text-primary);\n}\n\n.stTabs [aria-selected="true"] {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary) !important;\n  font-weight: var(--font-weight-bold);\n}\n\n/* Tables with better contrast */\ntable th {\n  background-color: var(--bg-tertiary);\n  color: var(--text-primary);\n  border: 2px solid var(--border-color);\n}\n\ntable td {\n  border: 1px solid var(--divider-color);\n}\n\n/* More pronounced impact indicators */\n.impact-indicator.high {\n  background-color: var(--error-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.medium {\n  background-color: var(--warning-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.low {\n  background-color: var(--success-color);\n  color: var(--bg-primary);\n} </style>'.lower

tests/integration/test_ui_integration.py:177: AssertionError
_________ TestSideBySideLayoutIntegration.test_switching_layout_modes __________

self = <tests.integration.test_ui_integration.TestSideBySideLayoutIntegration object at 0x11edc32d0>
layout_config = {'mode': <LayoutMode.STEP_BY_STEP: 'step_by_step'>, 'results_preview_enabled': True, 'sidebar_collapsed': False, 'sidebar_visible': True}
bet_scenario = ScenarioInput(scenario_name='BET Test Scenario', vehicle=BETParameters(name='Example BET', type=<VehicleType.BATTERY_E...n'>, loan_term_years=5, loan_interest_rate=0.07, down_payment_percentage=0.2), created_date=datetime.date(2025, 4, 14))
diesel_scenario = ScenarioInput(scenario_name='Diesel Test Scenario', vehicle=DieselParameters(name='Example Diesel Truck', type=<Vehicl...n'>, loan_term_years=5, loan_interest_rate=0.07, down_payment_percentage=0.2), created_date=datetime.date(2025, 4, 14))

    def test_switching_layout_modes(self, layout_config, bet_scenario, diesel_scenario):
        """Test switching between layout modes."""
>       from ui.layout import switch_layout_mode, LayoutMode, render_layout
E       ImportError: cannot import name 'switch_layout_mode' from 'ui.layout' (/Users/edwardmiller/dev/aus-tco/ui/layout.py)

tests/integration/test_ui_integration.py:196: ImportError
______________ TestResultsIntegration.test_dashboard_integration _______________

self = <tests.integration.test_ui_integration.TestResultsIntegration object at 0x11edc3990>
bet_scenario = ScenarioInput(scenario_name='BET Test Scenario', vehicle=BETParameters(name='Example BET', type=<VehicleType.BATTERY_E...n'>, loan_term_years=5, loan_interest_rate=0.07, down_payment_percentage=0.2), created_date=datetime.date(2025, 4, 14))
diesel_scenario = ScenarioInput(scenario_name='Diesel Test Scenario', vehicle=DieselParameters(name='Example Diesel Truck', type=<Vehicl...n'>, loan_term_years=5, loan_interest_rate=0.07, down_payment_percentage=0.2), created_date=datetime.date(2025, 4, 14))

    def test_dashboard_integration(self, bet_scenario, diesel_scenario):
        """Test integration of dashboard components."""
>       from ui.results.dashboard import render_dashboard
E       ImportError: cannot import name 'render_dashboard' from 'ui.results.dashboard' (/Users/edwardmiller/dev/aus-tco/ui/results/dashboard.py)

tests/integration/test_ui_integration.py:234: ImportError
_______ TestResultsIntegration.test_environmental_dashboard_integration ________

self = <tests.integration.test_ui_integration.TestResultsIntegration object at 0x11edd0050>
bet_scenario = ScenarioInput(scenario_name='BET Test Scenario', vehicle=BETParameters(name='Example BET', type=<VehicleType.BATTERY_E...n'>, loan_term_years=5, loan_interest_rate=0.07, down_payment_percentage=0.2), created_date=datetime.date(2025, 4, 14))
diesel_scenario = ScenarioInput(scenario_name='Diesel Test Scenario', vehicle=DieselParameters(name='Example Diesel Truck', type=<Vehicl...n'>, loan_term_years=5, loan_interest_rate=0.07, down_payment_percentage=0.2), created_date=datetime.date(2025, 4, 14))

    def test_environmental_dashboard_integration(self, bet_scenario, diesel_scenario):
        """Test integration of environmental dashboard components."""
>       from ui.results.environmental import render_environmental_dashboard
E       ImportError: cannot import name 'render_environmental_dashboard' from 'ui.results.environmental' (/Users/edwardmiller/dev/aus-tco/ui/results/environmental.py)

tests/integration/test_ui_integration.py:264: ImportError
_____________ TestEndToEndWorkflow.test_full_calculation_workflow ______________

self = <tests.integration.test_ui_integration.TestEndToEndWorkflow object at 0x11edd0910>
bet_scenario = ScenarioInput(scenario_name='BET Test Scenario', vehicle=BETParameters(name='Example BET', type=<VehicleType.BATTERY_E...n'>, loan_term_years=5, loan_interest_rate=0.07, down_payment_percentage=0.2), created_date=datetime.date(2025, 4, 14))
diesel_scenario = ScenarioInput(scenario_name='Diesel Test Scenario', vehicle=DieselParameters(name='Example Diesel Truck', type=<Vehicl...n'>, loan_term_years=5, loan_interest_rate=0.07, down_payment_percentage=0.2), created_date=datetime.date(2025, 4, 14))

    def test_full_calculation_workflow(self, bet_scenario, diesel_scenario):
        """Test a complete calculation workflow from inputs to results."""
        # Define helper functions for the tests
        def go_to_next_step(nav_state):
            """Helper function to navigate to next step."""
            return NavigationState(
                current_step=nav_state.next_step,
                completed_steps=nav_state.completed_steps + [nav_state.current_step],
                breadcrumb_history=nav_state.breadcrumb_history + [nav_state.next_step.replace("_", " ").title()],
                can_proceed=True,
                can_go_back=True,
                next_step="results" if nav_state.next_step == "operational_parameters" else "export",
                previous_step=nav_state.current_step
            )
    
        # Mock function to render a step
        def render_step(nav_state, step_id):
            """Mock function to render a step."""
            content = ""
            if step_id == "vehicle_parameters":
                content = "<div>Vehicle Parameters Form</div>"
            elif step_id == "operational_parameters":
                content = "<div>Operational Parameters Form</div>"
            elif step_id == "economic_parameters":
                content = "<div>Economic Parameters Form</div>"
            elif step_id == "results":
                content = "<div>Results Dashboard</div>"
            return content
    
        from ui.inputs.vehicle import render_vehicle_form
>       from ui.inputs.operational import render_operational_form
E       ImportError: cannot import name 'render_operational_form' from 'ui.inputs.operational' (/Users/edwardmiller/dev/aus-tco/ui/inputs/operational.py)

tests/integration/test_ui_integration.py:320: ImportError
=============================== warnings summary ===============================
tco_model/schemas.py:70
  /Users/edwardmiller/dev/aus-tco/tco_model/schemas.py:70: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    @validator('min_rate', 'max_rate')

tco_model/schemas.py:118
  /Users/edwardmiller/dev/aus-tco/tco_model/schemas.py:118: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    @validator('major_service_interval_km')

tco_model/schemas.py:131
  /Users/edwardmiller/dev/aus-tco/tco_model/schemas.py:131: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    @validator('year_5', 'year_10', 'year_15')

tco_model/schemas.py:165
  /Users/edwardmiller/dev/aus-tco/tco_model/schemas.py:165: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    @validator('min_rate', 'max_rate')

tests/integration/test_ui_integration.py::TestEndToEndWorkflow::test_configuration_persistence
tests/integration/test_ui_integration.py::TestEndToEndWorkflow::test_configuration_persistence
  /Users/edwardmiller/dev/aus-tco/utils/helpers.py:734: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    model_dict = model.dict()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform darwin, python 3.11.9-final-0 _______________

Name                       Stmts   Miss  Cover   Missing
--------------------------------------------------------
tco_model/__init__.py          1      0   100%
tco_model/calculator.py      239     85    64%   319, 324, 365, 382-397, 420-424, 430-431, 437, 465, 490-493, 527-579, 594-653, 676-697, 730
tco_model/costs.py           156    124    21%   27-31, 49-69, 90-155, 178-215, 233-261, 279-308, 332-368, 400, 412, 450-487
tco_model/models.py          503    119    76%   97-99, 104-107, 116-164, 179, 183-184, 188, 221-224, 249, 251, 255, 282, 284, 302-307, 327, 333-338, 360, 365, 369, 396, 441, 448, 460-462, 480, 488-498, 527, 544-550, 587-589, 637, 647, 652, 657, 662, 667, 672, 677, 682, 687, 692, 698, 703, 722, 739, 744, 785, 791, 798, 803, 808, 813, 839-857, 867-871
tco_model/schemas.py         122     12    90%   72-74, 120-122, 133-135, 167-169
tco_model/strategies.py      361     66    82%   39, 51, 72, 86, 124, 167, 199, 240, 245, 290, 328, 364-381, 395, 399, 404, 433, 445, 538, 584, 630, 642, 676, 716, 757, 824, 836, 866, 873-883, 917, 922, 945, 957, 986, 1028-1036, 1057, 1069, 1145, 1185, 1221, 1233, 1337, 1346-1360
tco_model/terminology.py     124     71    43%   604, 619, 631, 643-645, 670-704, 717, 730, 743-749, 763-767, 780-783, 797-815, 830-860
tco_model/vehicles.py        113    113     0%   8-330
--------------------------------------------------------
TOTAL                       1619    590    64%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/integration/test_ui_integration.py::TestThemeIntegration::test_theme_application_to_components - assert 'high_contrast' in '<style>/* ==========================================================================\n   high contrast theme for accessibility\n   ========================================================================== */\n\n:root {\n  /* base theme colors - high contrast for accessibility */\n  --bg-primary: #000000;\n  --bg-secondary: #1a1a1a;\n  --bg-tertiary: #2a2a2a;\n  --text-primary: #ffffff;\n  --text-secondary: #eeeeee;\n  --border-color: #ffffff;\n  --divider-color: #555555;\n  \n  /* high contrast specific rgb values for opacity usage */\n  --bet-primary-rgb: 0, 230, 200;\n  --diesel-primary-rgb: 255, 170, 0;\n  --error-color-rgb: 255, 80, 80;\n  --warning-color-rgb: 255, 190, 0;\n  --success-color-rgb: 50, 220, 50;\n  \n  /* adjusted component colors for better contrast */\n  --acquisition-color: #0099ff;\n  --energy-color: #ffaa00;\n  --maintenance-color: #00cc00;\n  --infrastructure-color: #ff5050;\n  --battery-color: #cc66ff;\n  --insurance-color: #ff66cc;\n  --taxes-color: #ff99cc;\n  --residual-color: #bbbbbb;\n  \n  /* vehicle type colors with higher contrast */\n  --bet-primary: #00e6c8;\n  --diesel-primary: #ffaa00;\n  \n  /* australian-themed accents with higher contrast */\n  --aus-green: #00ff77;\n  --aus-gold: #ffd700;\n  \n  /* status colors with higher contrast */\n  --success-color: #32dc32;\n  --warning-color: #ffbe00;\n  --error-color: #ff5050;\n  --info-color: #0099ff;\n  \n  /* ui element colors */\n  --card-bg: #1a1a1a;\n  --card-border: #ffffff;\n  --card-shadow: rgba(255, 255, 255, 0.2);\n  --input-bg: #1a1a1a;\n  --input-border: #ffffff;\n  --input-focus-border: #00e6c8;\n  --input-placeholder: #bbbbbb;\n  \n  /* chart colors */\n  --chart-grid-color: rgba(255, 255, 255, 0.3);\n  --chart-axis-color: rgba(255, 255, 255, 0.8);\n  --chart-tooltip-bg: rgba(0, 0, 0, 0.9);\n}\n\n/* high contrast theme specific adjustments */\nbody, .stapp {\n  background-color: var(--bg-primary);\n  color: var(--text-primary);\n}\n\n/* thicker borders for better visibility */\n.card, \n[data-testid="stexpander"], \n.sttextinput input,\n.stnumberinput input,\n.stdateinput input,\n.stselectbox > div[data-baseweb="select"] > div {\n  border-width: 2px;\n}\n\n/* higher contrast focus states */\n.sttextinput input:focus,\n.stnumberinput input:focus,\n.stdateinput input:focus,\n.stselectbox > div[data-baseweb="select"] > div:focus,\n.stbutton > button:focus {\n  outline: 2px solid var(--bet-primary);\n  box-shadow: 0 0 0 4px rgba(var(--bet-primary-rgb), 0.4);\n}\n\n/* buttons with higher contrast */\n.stbutton > button {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary);\n  font-weight: var(--font-weight-bold);\n}\n\n.stbutton > button:hover {\n  background-color: var(--text-primary);\n  color: var(--bg-primary);\n}\n\n/* form elements */\n.stcheckbox label span[role="checkbox"],\n.stradio label span[role="radio"] {\n  border-color: var(--text-primary);\n  border-width: 2px;\n}\n\n.stcheckbox label span[role="checkbox"][data-checked="true"],\n.stradio label span[role="radio"][data-checked="true"] {\n  background-color: var(--bet-primary);\n  border-color: var(--bet-primary);\n}\n\n/* improved contrast for tabs */\n.sttabs [data-baseweb="tab-list"] {\n  background-color: var(--bg-secondary);\n  border: 2px solid var(--border-color);\n}\n\n.sttabs [data-baseweb="tab"] {\n  color: var(--text-primary);\n}\n\n.sttabs [aria-selected="true"] {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary) !important;\n  font-weight: var(--font-weight-bold);\n}\n\n/* tables with better contrast */\ntable th {\n  background-color: var(--bg-tertiary);\n  color: var(--text-primary);\n  border: 2px solid var(--border-color);\n}\n\ntable td {\n  border: 1px solid var(--divider-color);\n}\n\n/* more pronounced impact indicators */\n.impact-indicator.high {\n  background-color: var(--error-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.medium {\n  background-color: var(--warning-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.low {\n  background-color: var(--success-color);\n  color: var(--bg-primary);\n} </style>'
 +  where '<style>/* ==========================================================================\n   high contrast theme for accessibility\n   ========================================================================== */\n\n:root {\n  /* base theme colors - high contrast for accessibility */\n  --bg-primary: #000000;\n  --bg-secondary: #1a1a1a;\n  --bg-tertiary: #2a2a2a;\n  --text-primary: #ffffff;\n  --text-secondary: #eeeeee;\n  --border-color: #ffffff;\n  --divider-color: #555555;\n  \n  /* high contrast specific rgb values for opacity usage */\n  --bet-primary-rgb: 0, 230, 200;\n  --diesel-primary-rgb: 255, 170, 0;\n  --error-color-rgb: 255, 80, 80;\n  --warning-color-rgb: 255, 190, 0;\n  --success-color-rgb: 50, 220, 50;\n  \n  /* adjusted component colors for better contrast */\n  --acquisition-color: #0099ff;\n  --energy-color: #ffaa00;\n  --maintenance-color: #00cc00;\n  --infrastructure-color: #ff5050;\n  --battery-color: #cc66ff;\n  --insurance-color: #ff66cc;\n  --taxes-color: #ff99cc;\n  --residual-color: #bbbbbb;\n  \n  /* vehicle type colors with higher contrast */\n  --bet-primary: #00e6c8;\n  --diesel-primary: #ffaa00;\n  \n  /* australian-themed accents with higher contrast */\n  --aus-green: #00ff77;\n  --aus-gold: #ffd700;\n  \n  /* status colors with higher contrast */\n  --success-color: #32dc32;\n  --warning-color: #ffbe00;\n  --error-color: #ff5050;\n  --info-color: #0099ff;\n  \n  /* ui element colors */\n  --card-bg: #1a1a1a;\n  --card-border: #ffffff;\n  --card-shadow: rgba(255, 255, 255, 0.2);\n  --input-bg: #1a1a1a;\n  --input-border: #ffffff;\n  --input-focus-border: #00e6c8;\n  --input-placeholder: #bbbbbb;\n  \n  /* chart colors */\n  --chart-grid-color: rgba(255, 255, 255, 0.3);\n  --chart-axis-color: rgba(255, 255, 255, 0.8);\n  --chart-tooltip-bg: rgba(0, 0, 0, 0.9);\n}\n\n/* high contrast theme specific adjustments */\nbody, .stapp {\n  background-color: var(--bg-primary);\n  color: var(--text-primary);\n}\n\n/* thicker borders for better visibility */\n.card, \n[data-testid="stexpander"], \n.sttextinput input,\n.stnumberinput input,\n.stdateinput input,\n.stselectbox > div[data-baseweb="select"] > div {\n  border-width: 2px;\n}\n\n/* higher contrast focus states */\n.sttextinput input:focus,\n.stnumberinput input:focus,\n.stdateinput input:focus,\n.stselectbox > div[data-baseweb="select"] > div:focus,\n.stbutton > button:focus {\n  outline: 2px solid var(--bet-primary);\n  box-shadow: 0 0 0 4px rgba(var(--bet-primary-rgb), 0.4);\n}\n\n/* buttons with higher contrast */\n.stbutton > button {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary);\n  font-weight: var(--font-weight-bold);\n}\n\n.stbutton > button:hover {\n  background-color: var(--text-primary);\n  color: var(--bg-primary);\n}\n\n/* form elements */\n.stcheckbox label span[role="checkbox"],\n.stradio label span[role="radio"] {\n  border-color: var(--text-primary);\n  border-width: 2px;\n}\n\n.stcheckbox label span[role="checkbox"][data-checked="true"],\n.stradio label span[role="radio"][data-checked="true"] {\n  background-color: var(--bet-primary);\n  border-color: var(--bet-primary);\n}\n\n/* improved contrast for tabs */\n.sttabs [data-baseweb="tab-list"] {\n  background-color: var(--bg-secondary);\n  border: 2px solid var(--border-color);\n}\n\n.sttabs [data-baseweb="tab"] {\n  color: var(--text-primary);\n}\n\n.sttabs [aria-selected="true"] {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary) !important;\n  font-weight: var(--font-weight-bold);\n}\n\n/* tables with better contrast */\ntable th {\n  background-color: var(--bg-tertiary);\n  color: var(--text-primary);\n  border: 2px solid var(--border-color);\n}\n\ntable td {\n  border: 1px solid var(--divider-color);\n}\n\n/* more pronounced impact indicators */\n.impact-indicator.high {\n  background-color: var(--error-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.medium {\n  background-color: var(--warning-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.low {\n  background-color: var(--success-color);\n  color: var(--bg-primary);\n} </style>' = <built-in method lower of str object at 0x128b75e00>()
 +    where <built-in method lower of str object at 0x128b75e00> = '<style>/* ==========================================================================\n   High Contrast Theme for Accessibility\n   ========================================================================== */\n\n:root {\n  /* Base theme colors - high contrast for accessibility */\n  --bg-primary: #000000;\n  --bg-secondary: #1a1a1a;\n  --bg-tertiary: #2a2a2a;\n  --text-primary: #ffffff;\n  --text-secondary: #eeeeee;\n  --border-color: #ffffff;\n  --divider-color: #555555;\n  \n  /* High contrast specific RGB values for opacity usage */\n  --bet-primary-rgb: 0, 230, 200;\n  --diesel-primary-rgb: 255, 170, 0;\n  --error-color-rgb: 255, 80, 80;\n  --warning-color-rgb: 255, 190, 0;\n  --success-color-rgb: 50, 220, 50;\n  \n  /* Adjusted component colors for better contrast */\n  --acquisition-color: #0099ff;\n  --energy-color: #ffaa00;\n  --maintenance-color: #00cc00;\n  --infrastructure-color: #ff5050;\n  --battery-color: #cc66ff;\n  --insurance-color: #ff66cc;\n  --taxes-color: #ff99cc;\n  --residual-color: #bbbbbb;\n  \n  /* Vehicle type colors with higher contrast */\n  --bet-primary: #00E6C8;\n  --diesel-primary: #FFAA00;\n  \n  /* Australian-themed accents with higher contrast */\n  --aus-green: #00FF77;\n  --aus-gold: #FFD700;\n  \n  /* Status colors with higher contrast */\n  --success-color: #32DC32;\n  --warning-color: #FFBE00;\n  --error-color: #FF5050;\n  --info-color: #0099FF;\n  \n  /* UI element colors */\n  --card-bg: #1a1a1a;\n  --card-border: #ffffff;\n  --card-shadow: rgba(255, 255, 255, 0.2);\n  --input-bg: #1a1a1a;\n  --input-border: #ffffff;\n  --input-focus-border: #00E6C8;\n  --input-placeholder: #bbbbbb;\n  \n  /* Chart colors */\n  --chart-grid-color: rgba(255, 255, 255, 0.3);\n  --chart-axis-color: rgba(255, 255, 255, 0.8);\n  --chart-tooltip-bg: rgba(0, 0, 0, 0.9);\n}\n\n/* High contrast theme specific adjustments */\nbody, .stApp {\n  background-color: var(--bg-primary);\n  color: var(--text-primary);\n}\n\n/* Thicker borders for better visibility */\n.card, \n[data-testid="stExpander"], \n.stTextInput input,\n.stNumberInput input,\n.stDateInput input,\n.stSelectbox > div[data-baseweb="select"] > div {\n  border-width: 2px;\n}\n\n/* Higher contrast focus states */\n.stTextInput input:focus,\n.stNumberInput input:focus,\n.stDateInput input:focus,\n.stSelectbox > div[data-baseweb="select"] > div:focus,\n.stButton > button:focus {\n  outline: 2px solid var(--bet-primary);\n  box-shadow: 0 0 0 4px rgba(var(--bet-primary-rgb), 0.4);\n}\n\n/* Buttons with higher contrast */\n.stButton > button {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary);\n  font-weight: var(--font-weight-bold);\n}\n\n.stButton > button:hover {\n  background-color: var(--text-primary);\n  color: var(--bg-primary);\n}\n\n/* Form elements */\n.stCheckbox label span[role="checkbox"],\n.stRadio label span[role="radio"] {\n  border-color: var(--text-primary);\n  border-width: 2px;\n}\n\n.stCheckbox label span[role="checkbox"][data-checked="true"],\n.stRadio label span[role="radio"][data-checked="true"] {\n  background-color: var(--bet-primary);\n  border-color: var(--bet-primary);\n}\n\n/* Improved contrast for tabs */\n.stTabs [data-baseweb="tab-list"] {\n  background-color: var(--bg-secondary);\n  border: 2px solid var(--border-color);\n}\n\n.stTabs [data-baseweb="tab"] {\n  color: var(--text-primary);\n}\n\n.stTabs [aria-selected="true"] {\n  background-color: var(--bet-primary);\n  color: var(--bg-primary) !important;\n  font-weight: var(--font-weight-bold);\n}\n\n/* Tables with better contrast */\ntable th {\n  background-color: var(--bg-tertiary);\n  color: var(--text-primary);\n  border: 2px solid var(--border-color);\n}\n\ntable td {\n  border: 1px solid var(--divider-color);\n}\n\n/* More pronounced impact indicators */\n.impact-indicator.high {\n  background-color: var(--error-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.medium {\n  background-color: var(--warning-color);\n  color: var(--bg-primary);\n}\n\n.impact-indicator.low {\n  background-color: var(--success-color);\n  color: var(--bg-primary);\n} </style>'.lower
FAILED tests/integration/test_ui_integration.py::TestSideBySideLayoutIntegration::test_switching_layout_modes - ImportError: cannot import name 'switch_layout_mode' from 'ui.layout' (/Users/edwardmiller/dev/aus-tco/ui/layout.py)
FAILED tests/integration/test_ui_integration.py::TestResultsIntegration::test_dashboard_integration - ImportError: cannot import name 'render_dashboard' from 'ui.results.dashboard' (/Users/edwardmiller/dev/aus-tco/ui/results/dashboard.py)
FAILED tests/integration/test_ui_integration.py::TestResultsIntegration::test_environmental_dashboard_integration - ImportError: cannot import name 'render_environmental_dashboard' from 'ui.results.environmental' (/Users/edwardmiller/dev/aus-tco/ui/results/environmental.py)
FAILED tests/integration/test_ui_integration.py::TestEndToEndWorkflow::test_full_calculation_workflow - ImportError: cannot import name 'render_operational_form' from 'ui.inputs.operational' (/Users/edwardmiller/dev/aus-tco/ui/inputs/operational.py)
=================== 5 failed, 5 passed, 6 warnings in 0.51s ====================
